/*!
* WP Grid Builder
*
* @package   WP Grid Builder
* @author    Loïc Blascos
* @link      https://www.wpgridbuilder.com
* @copyright 2019-2025 Loïc Blascos
*
*/
(()=>{var e={957:()=>{function e(e){if("apply"!==this.facet.type)return;const{isShadow:t}=this.options,{settings:s,slug:i}=this.facet,{apply_redirect:n,apply_history:r}=s,a=this.facet.html&&e.querySelector("button.wpgb-apply");this.facet.rendered||a&&a.addEventListener("click",(()=>c.apply(this,[i]))),n&&t||(this.appliedParams=this.getParams()),this.autoRefresh=n&&t&&this.autoRefresh,this.history=this.history&&(!t||r),this.facet.rendered=!0,a&&(a.disabled=this.facet.disabled??!1),this.facet.html?(u.call(this,a),p.call(this,a)):this.facet.rendered=!1}function t(){"appliedParams"in this&&(this.appliedParams=this.getParams())}function s(e,t){if(!("appliedParams"in this))return;const s=this.getFacet(e)[0],i=s&&s.id,n=this.facet&&this.facet.type||s&&s.type;this.autoRefresh=!1,["sort","reset","selection","pagination","load_more","per_page"].includes(n)||a.call(this).includes(i)?(this.autoRefresh=!0,this.appliedParams[e]=t,l.call(this,e)):o.call(this)}function i(){"appliedParams"in this&&(this.appliedParams=this.getParams())}function n(e){"appliedParams"in this&&(e.forEach((e=>delete this.appliedParams[e])),l.call(this,""))}function r(){const e=[];for(const t in this.facets)this.facets[t].forEach((t=>"apply"===t.type&&e.push(t)));return e}function a(){let e=[];return r.call(this).forEach((t=>{e=[...e,...t.settings.apply_excluded||[]]})),e.map(Number)}function o(){r.call(this).forEach((e=>p.call(this,e.holder.querySelector("button.wpgb-apply"))))}function l(e){for(const e in this.getParams())!this.appliedParams[e]&&this.setParams(e,[]);for(const t in this.appliedParams)t!==e&&this.setParams(t,this.appliedParams[t])}function c(e){const t=this.getFacet(e)[0];t&&t.settings.apply_redirect?d.apply(this,[e]):h.apply(this,[e])}function d(e){const t=this.getFacet(e)[0];if(this.options.isGutenberg||!t||!t.settings.apply_url)return;let s="";try{s=new URL(t.settings.apply_url)}catch{s=new URL(window.location.href)}if(!s?.searchParams){const e=this.getQueryString(),s=t.settings.apply_url.includes("?")?"&":"?";return void(window.location.href=t.settings.apply_url+(e?s+e:""))}const i=this.getParams();for(const e in i){const t=`_${e}`,n=s.searchParams.get(t||{})?.split(",")||[];s.searchParams.set(t,[...new Set([...n,...i[e]])].join(","))}window.location.href=s.href}function h(e){this.emit("apply",[e]),this.appliedParams=this.getParams(),this.autoRefresh=!0,this.refresh()}function u(e){const t=this.facet.html&&document.createRange().createContextualFragment(this.facet.html),s=t&&t.querySelector("button.wpgb-apply");s&&e&&(e.textContent=s.textContent)}function p(e){"appliedParams"in this&&e&&(e.disabled=function(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e){if(!t[s])return!1;if(JSON.stringify([...e[s]].sort())!==JSON.stringify([...t[s]].sort()))return!1}return!0}(this.appliedParams||{},this.getParams()))}window.WP_Grid_Builder.on("init",(function(r){r.facets.on("render",e),r.facets.on("prefilter",t),r.facets.on("change",s),r.facets.on("refresh",i),r.facets.on("reset",n)}))},4540:()=>{function e(e){let{target:s}=e;const n=s.closest(".wpgb-checkbox"),r=n&&n.closest('li[role="treeitem"][aria-expanded="false"]');t.call(this,s),i.call(this,n),n&&n.closest("li").querySelector('[aria-pressed="true"]')&&"false"===n.getAttribute("aria-pressed")&&n.setAttribute("aria-pressed","mixed"),r&&"true"===n.getAttribute("aria-pressed")&&r.click()}function t(e){let t=!1;for(;e=n(e);){let i=r(e),n=e.getAttribute("aria-pressed");t=t||[...i].filter((e=>"true"===e.getAttribute("aria-pressed"))).length,t&&"false"===n&&e.setAttribute("aria-pressed","mixed"),!t&&"mixed"===n&&e.setAttribute("aria-pressed","false"),t&&s.call(this,e)}}function s(e){let{name:t,value:s}=e.querySelector("input");e.setAttribute("aria-pressed","mixed"),this.deleteParams(t.replace("[]",""),[s])}function i(e){r(e).forEach((e=>{let{name:t,value:s}=e.querySelector("input");e.setAttribute("aria-pressed","false"),this.deleteParams(t.replace("[]",""),[s])}))}function n(e){return(e=(e=e.closest("ul"))&&e.closest("li"))&&e.querySelector(".wpgb-checkbox")}function r(e){return(e=(e=e.closest("li"))&&e.querySelector("ul"))&&e.querySelectorAll(".wpgb-checkbox")||[]}window.WP_Grid_Builder.on("init",(function(t){t.facets.on("render",(function(t){if("checkbox"!==this.facet.type||!this.facet.settings.hierarchical)return;!function(e){e.forEach((e=>{for(;e=n(e);)"false"===e.getAttribute("aria-pressed")&&e.setAttribute("aria-pressed","mixed")}))}(t.querySelectorAll('.wpgb-checkbox[aria-pressed="true"]')),!t._onChange&&t.addEventListener("change",e.bind(this)),t._onChange=!0}))}))},4705:()=>{const e="undefined"!=typeof Map&&new Map;window.WP_Grid_Builder.on("init",(function(t){t.facets.on("render",(function(t){const{type:s,focused:i}=this.facet;if(function(t,s,i){const n=t.querySelector("button.wpgb-toggle-hidden");if(!n)return;const r=n.previousElementSibling,a=`wpgb-${Math.random().toString(36).substr(2,9)}`;n.setAttribute("aria-controls",a),r.id=a,function(t,s,i){if(e.has(t))e.get(t)&&(s.setAttribute("aria-expanded",!1),i.toggleHidden(!1,i.facet));else{t.querySelector('li[hidden] [role="button"][aria-pressed="true"] input[type="hidden"]')&&i.toggleHidden(!1,i.facet)}}(t,n,i),s&&s.classList.contains("wpgb-toggle-hidden")&&n.focus({preventScroll:!0})}(t,i,this),i&&t)switch(s){case"load_more":!function(e){const t=e.querySelector(".wpgb-load-more");requestAnimationFrame((()=>t&&t.focus({preventScroll:!0})))}(t);break;case"pagination":!function(e,t){let s=parseInt(t.getAttribute("data-page")||0,10);if(s){const i=t.textContent;e.querySelectorAll(`a[data-page="${s-1}"], a[data-page="${s}"], a[data-page="${s+1}"]`).forEach((e=>i===e.textContent&&e.focus({preventScroll:!0})))}}(t,i);break;case"selection":case"number":case"range":case"date":case"search":case"autocomplete":case"geolocation":case"map":case"result_count":case"reset":case"apply":break;default:!function(e,t){const s=t.facet.focused.querySelector("input");if(s){const i=s.value,n=e.querySelector(`[role="button"] input[type="hidden"][value="${CSS.escape(i)}"]`),r=n&&n.closest('[role="button"]');t.facet.settings.treeview||r&&r.focus({preventScroll:!0})}}(t,this)}})),t.facets.on("toggle",((t,s)=>e.set(t.holder,s)))}))},1542:()=>{function e(e){if("reset"!==this.facet.type)return;const s=this.facet.html&&e.querySelector("button.wpgb-reset");s&&t.call(this,s)}function t(e){const t=this.facet.settings.reset_facet||[],s=this.facet.disabled;requestAnimationFrame((()=>{setTimeout((()=>{const i=Object.keys(this.getParams());let n=i.length;Array.isArray(t)&&t.length&&(n=t.filter((e=>this.facets[e]&&this.facets[e][0]&&i.includes(this.facets[e][0].slug))).length),e.disabled=s||!n}))}))}window.WP_Grid_Builder.on("init",(function(t){t.facets.on("render",e)}))},4828:()=>{const e="undefined"!=typeof Map&&new Map;function t(e){const{target:t}=e;"LI"===t.tagName&&t.hasAttribute("tabindex")&&(this.querySelectorAll('li[tabindex="0"]').forEach((e=>e.tabIndex=-1)),t.tabIndex=0)}function s(t){let{target:s}=t;if("treeitem"!==s.getAttribute("role"))return;const i=e.get(this),r=s.getAttribute("aria-expanded");n(i,s,"false"===r),l(s)}function i(t){const s=t.target.closest("li");if(!s)return;const i=e.get(this);switch(t.key){case" ":case"Enter":!function(e){const t=e.querySelector('.wpgb-checkbox[role=button]:not([tabindex="-1"])');t&&t.click()}(s);break;case"*":case"Multiply":!function(e,t){const s=t.closest("ul").children;[...s].forEach((t=>n(e,t,!0)))}(i,s);break;case"Home":!function(e){const t=e.items[0];!l(t)&&r(e,t)}(i);break;case"End":!function(e){const t=e.items[e.items.length-1];!l(t)&&a(e,t)}(i);break;case"Left":case"ArrowLeft":"true"===s.getAttribute("aria-expanded")?n(i,s,!1):a(i,s,!0);break;case"Right":case"ArrowRight":"true"===s.getAttribute("aria-expanded")?r(i,s,!0):n(i,s,!0);break;case"Down":case"ArrowDown":r(i,s);break;case"Up":case"ArrowUp":a(i,s);break;default:return void function(e,t,s){const{items:i}=e,{length:n}=i,r=[...i].indexOf(t);for(let e=r+1;e<n;e++)if(o(i[e],s)&&l(i[e]))return;for(let e=0;e<r;e++)if(o(i[e],s)&&l(i[e]))return}(i,s,t.key)}t.preventDefault()}function n(t,s,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!s.hasAttribute("aria-expanded")||!n&&null===s.offsetParent)return;const r=s.closest(".wpgb-facet"),a=s.querySelector("input");s.setAttribute("aria-expanded",i),i?t.states[a.value]=!0:delete t.states[a.value],e.set(r,t)}function r(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{items:i}=e,{length:n}=i,r=[...i].indexOf(t),a=s&&t.querySelector("ul");if(!(r>=n-1))for(let e=r+1;e<n&&(s&&a!==i[e].parentElement||!l(i[e]));e++);}function a(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{items:i}=e,n=[...i].indexOf(t);if(!(n<1))for(let e=n-1;e>=0&&(s&&!i[e].contains(t)||!l(i[e]));e--);}function o(e,t){return e.textContent.charAt(0).toLowerCase()===t}function l(e){return!!c(e)&&(e.focus(),!0)}function c(e){return null!==e.offsetParent&&!e.querySelector("input").disabled}window.WP_Grid_Builder.on("init",(function(r){r.facets.on("render",(function(n){if("checkbox"!==this.facet.type||!this.facet.settings.treeview)return;const r=e.has(n),a=e.get(n)||{states:{}},o=n.querySelectorAll(".wpgb-checkbox-facet li");if(function(e,t){for(const s in t){const t=e.querySelector(`li[role=treeitem] input[value="${s}"]`);t&&t.closest("li").setAttribute("aria-expanded",!0)}}(n,a.states),e.set(n,{...a,items:o}),r||(n.addEventListener("click",s),n.addEventListener("keydown",i),n.addEventListener("focus",t,!0),function(t,s){const{selected:i}=t,{holder:n}=t;i.forEach((e=>{let t=n.querySelector(`input[value="${e}"]`),i=t&&t.closest("li[role=treeitem][aria-expanded=false]");for(i&&(i.setAttribute("aria-expanded",!0),s.states[i.querySelector("input").value]=!0),t=t&&t.closest("ul");t;)t=t.closest("li[role=treeitem][aria-expanded=false]"),t&&(t.setAttribute("aria-expanded",!0),s.states[t.querySelector("input").value]=!0)})),e.set(n,{...s,states:s.states})}(this.facet,e.get(n))),this.facet.focused){const e=this.facet.focused.querySelector("input");if(e){const t=n.querySelector(`[role="button"] input[type="hidden"][value="${e.value}"]`),s=t&&t.closest('[role="button"]');if(s)return void s.closest("li").focus({preventScroll:!0})}}for(let e=0;e<o.length;e++)if(c(o[e])){o[e].tabIndex=0;break}})),r.facets.on("toggle",(function(t,s){"checkbox"===t.type&&t.settings.treeview&&!s&&function(t){const{holder:s}=t,i=s.querySelector('li[tabindex="0"][hidden], li[hidden] li[tabindex="0"]'),r=e.get(s);if(r.items&&r.items.forEach((e=>null===e.offsetParent&&n(r,e,!1,!0))),r&&i){const{items:e}=r;for(let t=[...e].indexOf(i)-1;t>=0;t--)if(c(e[t])){e[t].tabIndex=0,i.tabIndex=-1;break}}}(t)}))}))},694:()=>{const e=document.createElement("div"),t="wpgb-content",s=new RegExp(`^${t}`,"i");function i(e){return e=(e=e.replace(/%[a-fA-F0-9]{2}/g,"")).replace(/[^A-Za-z0-9_-]/g,""),CSS.escape(e)}window.addEventListener("wpgb.loaded",(()=>{wpgb_settings&&wpgb_settings.shadowGrids&&wpgb_settings.shadowGrids.forEach((n=>{let r={id:n,isShadow:!0},a=e.cloneNode();/^\d+$/.test(n)||(r.isTemplate=!0),s.test(n)&&(a=function(e,s){let n=`.${i(s.id)}:not([hidden])`,r=document.querySelector(`${n}:not([data-instance])`);if(n+=` > *:not([class*="${t}"])`,r){const e=r.querySelector(`[class*="${t}"][hidden]`);e&&e.parentElement.removeChild(e)}else{if(n=`.${i(s.id)}`,r=document.querySelector(`${n}:not([data-instance])`),r&&r.parentElement){const e=r;r=r.parentElement,e.parentElement.removeChild(e)}n+=` ~ *:not([class*="${t}"])`}r&&(delete s.isShadow,r.querySelector(".wpgb-facet")&&console.error(`Facets should not be placed in '${s.id}' element.`));return s.customContent=!0,s.itemSelector=n,s.ajaxUrl=wpgb_settings.permalink+"?"+wpgb_settings.ajaxUrl.split(/[?#]/)[1],r||e}(a,r),r.id=n.trim()),WP_Grid_Builder.instantiate(a,r).init()}))}))},4156:function(e,t,s){(function(e){if(e.CSS&&e.CSS.escape)return e.CSS.escape;var t=function(e){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var t,s=String(e),i=s.length,n=-1,r="",a=s.charCodeAt(0);++n<i;)0!=(t=s.charCodeAt(n))?r+=t>=1&&t<=31||127==t||0==n&&t>=48&&t<=57||1==n&&t>=48&&t<=57&&45==a?"\\"+t.toString(16)+" ":0==n&&1==i&&45==t||!(t>=128||45==t||95==t||t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122)?"\\"+s.charAt(n):s.charAt(n):r+="�";return r};e.CSS||(e.CSS={}),e.CSS.escape=t})(void 0!==s.g?s.g:this)}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,s),r.exports}s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{"use strict";const e=function(e){let t;"function"==typeof Event?t=new CustomEvent(e):(t=document.createEvent("CustomEvent"),t.initEvent(e,!0,!0)),window.dispatchEvent(t)};s(4156);const t=[],i=(()=>{const e=document.createElement("link").relList;return!!(e&&e.supports&&e.supports("preload"))})();class n{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e&&(this.library=e,this.callback=s,this.getScript(),this.script))return this.isLoaded()?this.callback&&this.callback():void(this.isLoading()?this.bindEvents(t[this.script.handle].element):this.loadScript())}getScript(){this.script=wpgb_settings.vendors.filter((e=>{let{handle:t}=e;return t===this.library})),this.script=this.script.shift()}isLoaded(){return t[this.library]&&t[this.library].loaded}isLoading(){return t[this.library]&&t[this.library].loading}loadScript(){const e=document.createElement("css"===this.script.type?"link":"script"),s=this.script.version?`?v=${this.script.version}`:"",n=this.script.source+s;this.bindEvents(e),"css"===this.script.type?(e.rel=i?"preload":"stylesheet",i&&(e.as="style"),e.href=n):e.src=n,document.head.appendChild(e),t[this.script.handle]={loading:!0,element:e}}onLoad(){const e=t[this.script.handle];"preload"===e.element.rel&&(e.element.rel="stylesheet",e.element.removeAttribute("as")),e.loaded=!0,this.callback&&this.callback()}onError(){t[this.script.handle].error=!0}bindEvents(e){e.addEventListener("load",(()=>this.onLoad())),e.addEventListener("error",(()=>this.onerror()))}}class r{constructor(){this.listeners=new Map}canListen(e,t){return!("function"!=typeof t||!e)||(!("object"!=typeof t||!t[e])||(console.error(`Invalid listener for event name: "${e}"`),!1))}exists(e,t){if(this.listeners.has(e))return this.listeners.get(e).find((e=>e.listener===t))}on(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.canListen(e,t)?(this.listeners.has(e)||this.listeners.set(e,[]),this.exists(e,t)||this.listeners.get(e).push({listener:t,once:s}),this):this}once(e,t){return this.on(e,t,!0)}off(e,t){const s=this.listeners.get(e)||[],i=s.findIndex((e=>e.listener===t));return i>-1&&s.splice(i,1),s.length<1&&this.listeners.delete(e),this}offAll(){return this.listeners.clear(),this}emit(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];return[...this.listeners.get(e)||[]].forEach((t=>{t.once&&this.off(e,t.listener),"object"==typeof t.listener?t.listener[e].apply(t.listener,...s):t.listener.apply(this,...s)})),this}}class a extends r{constructor(){super(),this.vendors={},this.instances={}}get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const{instances:t}=this,s=[];if(!Object.keys(t).length)return[];for(const i in t)(t[i].id||"").toString()===e.toString()&&s.push(t[i]);return s}instance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object.keys(this.instances).length&&this.instances[e]?this.instances[e]:{}}}const o={get:()=>[],instance:()=>[],instances:()=>[],instantiate:()=>[],on:()=>null,off:()=>null,once:()=>null,offAll:()=>null,emit:()=>null,vendors:{},unsupported:!0};if(!window?.WP_Grid_Builder?.instance){const e=!!(Math.sign&&Array.from&&Array.prototype.fill&&Array.prototype.find&&Array.prototype.findIndex&&Array.prototype.includes&&Element.prototype.matches&&Element.prototype.closest&&NodeList.prototype.forEach&&window.Map&&window.URLSearchParams);window.WP_Grid_Builder=e?Object.assign(new a,window?.WP_Grid_Builder||{}):Object.assign(o,window?.WP_Grid_Builder||{})}const l={},c={},d={};let h=0;class u extends r{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(super(),e){if(e.instance)return d[e.instance];this.element=e,this.options={...c,...t},this.htmlInit(),this.id=this.options.id,this.setInstance(),this.intiFacets()}}setInstance(){this.instance=++h,this.element.instance=this.instance,d[this.instance]=this}htmlInit(){let e=this.element.getAttribute("data-options");e&&(e=JSON.parse(e),this.options={...this.options,...e},this.element.removeAttribute("data-options"))}intiFacets(){this.facets=WP_Grid_Builder.Facets(this.element,this.options)}init(){this.element&&(this.element.classList.add("wpgb-enabled"),this.element.setAttribute("data-instance",this.instance),window.WP_Grid_Builder.emit("init",[this]),this.facets&&this.facets.init())}destroy(){const e=Object.getOwnPropertyNames(this);if(this.element){this.facets.destroy(),this.element.classList.remove("wpgb-enabled"),this.element.setAttribute("data-options",JSON.stringify(this.options)),delete WP_Grid_Builder.instances[this.instance],delete this.element.instance,delete l[this.instance],delete d[this.instance];for(let t=0;t<e.length;t++)delete this[e[t]]}}}class p extends r{canObserve(){return"IntersectionObserver"in window&&"isIntersecting"in window.IntersectionObserverEntry.prototype}observe(){this.canObserve()?this.loader&&this.observer().observe(this.loader):(window.addEventListener("scroll",this),this.check())}unObserve(){if(this.intersection)return this.intersection.disconnect(),void delete this.intersection;window.removeEventListener("scroll",this)}observer(){return this.intersection=new IntersectionObserver(((e,t)=>{e.forEach((e=>{e.isIntersecting&&this.loader&&this.loader.click()}))}),{rootMargin:"600px"}),this.intersection}check(){this.loader&&this.inView()&&this.loader&&this.loader.click()}inView(e){const{top:t,bottom:s}=this.loader.getBoundingClientRect(),i=window.innerHeight;return t>=600&&t<=i||s>=0&&s<=i}onscroll=function(e,t){let s=0;return function(){const i=(new Date).getTime();if(!(i-s<t))return s=i,e(...arguments)}}((()=>this.check()),100)}class g extends p{bindEvents(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e=e?"addEventListener":"removeEventListener",this.history&&window[e]("popstate",this),document[e]("click",this,!0),document[e]("change",this,!1),document[e]("keydown",this,!1),document[e]("mousedown",this,!1)}handleEvent(e){const t="on"+e.type;this[t]&&this[t](e)}isFacet(e){const t=`.wpgb-facet[data-grid="${CSS.escape(this.options.id)}"]`,s=e&&e.closest(t),i=s&&s.closest(".wp-grid-builder");if(!s)return!1;if(i&&i!==this.element)return!1;const n=this.getFacet(s.getAttribute("data-facet"));return n&&n.forEach((e=>{e.holder!==s||(this.facet=e)})),!!this.facet}onpopstate(e){const{state:t}=e;t&&t.WP_Grid_Builder===this.options.id&&(delete this.loadMoreSlug,delete this.loadPageSlug,this.getURLParams(),this.fetch())}onclick(e){if(this.isFacet(e.target)){switch(this.facet.type){case"pagination":this.handlePagination(e);break;case"load_more":this.handleLoadMore(e);break;case"reset":this.handleReset(e)}e.target.closest(".wpgb-toggle-hidden")&&this.toggleHidden(e,this.facet),this.toggleButton(e),delete this.facet}}onmousedown(e){if(!this.isFacet(e.target))return;e.target.closest('[class^="wpgb"][role="button"][tabindex="-1"]')&&e.preventDefault(),delete this.facet}onchange(e){if(!this.isFacet(e.target)||!("type"in this.facet))return;const{value:t,name:s}=e.target,i=s.replace("[]",""),n=this.getInputType(e.target,this.facet);let r;r="select-multiple"===n?this.getSelectValues(e):this.getValues(e,t),"checkbox"===n?this.diffParams(i,r):this.setParams(i,r),this.emit("change",[i,this.getParams(i)]),this.refresh(),delete this.facet}onkeydown(e){const{keyCode:t}=e;[13,32].includes(t)&&this.isFacet(e.target)&&(this.toggleButton(e),delete this.facet)}handlePagination(e){const t=e.target.getAttribute("data-page");if(!t)return;const s=e.target.closest("ul"),i=s&&s.querySelector("[aria-current]");i&&i.removeAttribute("aria-current"),e.target.setAttribute("aria-current",!0),e.preventDefault(),this.loadPage(t),this.scrollToTop()}scrollToTop(){const e=this.facet.settings;if(!e.scroll_to_top)return;let t=this.element.querySelector(".wpgb-layout")||this.element,s=t.getBoundingClientRect().top+window.pageYOffset+e.scroll_to_top_offset;t.tabIndex=-1,t.focus({preventScroll:!0}),"scrollBehavior"in document.documentElement.style?window.scrollTo({top:s,behavior:"smooth"}):document.documentElement.scrollTop=s}handleLoadMore(e){const{settings:t}=this.facet;!t||t.offset+t.number<1||e.target.closest(".wpgb-load-more")&&this.loadMore()}handleReset(e){const{settings:t}=this.facet;let s=t&&t.reset_facet;e.target.closest(".wpgb-reset")&&(s=s.length&&"object"!=typeof s?[s||0]:s,s=s.length&&s.map((e=>(e=this.getFacet(parseInt(e,10)))&&e[0]&&e[0].slug)).filter((e=>e)),this.reset(s))}toggleButton(e){const{target:t}=e,s=t.closest('[role="button"]');if(!s)return;const i="true"===s.getAttribute("aria-pressed"),n=s.querySelector("input");if(!n||"-1"===s.getAttribute("tabindex"))return;e.preventDefault(),e.stopImmediatePropagation();const{value:r}=n,a=this.getInputType(n,this.facet);if(i&&"radio"===a&&""===r)return;const o=t.closest(".wpgb-facet");if("radio"===a){const e=o.querySelectorAll('[role="button"][aria-pressed="true"]');if(e.forEach((e=>e.setAttribute("aria-pressed",!1))),i&&e){const e=o.querySelector('[role="button"] input[type="hidden"][value=""]');e&&e.parentElement.setAttribute("aria-pressed",!0)}}else{if(o.querySelectorAll('[role="button"][aria-pressed="true"] input[type="hidden"][value=""]').forEach((e=>e.parentElement.setAttribute("aria-pressed",!1))),i&&1===o.querySelectorAll('[role="button"][aria-pressed="true"]').length){const e=o.querySelector('[role="button"] input[type="hidden"][value=""]');e&&e.parentElement.setAttribute("aria-pressed",!0)}}s.setAttribute("aria-pressed",(!i).toString()),n.checked=!i,"checkbox"===a&&this.facet?.settings?.treeview&&s.closest('[role="treeitem"]')?.setAttribute("aria-selected",(!i).toString()),i&&"radio"===a&&(n.value=""),"function"==typeof Event?e=new Event("change",{bubbles:!0}):(e=document.createEvent("Event")).initEvent("change",!0,!0),n.dispatchEvent(e),n.value=r}toggleHidden(e,t){const{holder:s,settings:i}=t,n=s.querySelector("ul"),r=n&&s.querySelector(".wpgb-toggle-hidden"),a=r&&"true"===r.getAttribute("aria-expanded"),o=n&&a&&n.querySelectorAll("[hidden]");n&&(e&&e.stopImmediatePropagation(),r.textContent=a?i.show_more_label.replace("[number]",o.length):i.show_less_label,r.setAttribute("aria-expanded",!a),n.classList.toggle("wpgb-expanded"),this.emit("toggle",[t,!a]))}getValues(e,t){let s=[];return""===t?s:(s="range"===this.facet.type?this.getRange(e):this.getInput(t),s.map(String).filter(((e,t,s)=>s.indexOf(e)===t)))}getSelectValues(e){return[...e.target.closest("select").options].filter((e=>e.selected)).map((e=>e.value))}getInput(e){let t=[];try{e=JSON.parse(e)}catch(e){}return Array.isArray(e)?t=e:t.push(e),t}getInputType(e,t){let s=e.type;return"select-multiple"===s||("checkbox"===t.type||"selection"===t.type||t.settings&&t.settings.multiple&&e.value?s="checkbox":"hidden"===s&&(s="radio")),s}getRange(e){const t=[...e.target.closest(".wpgb-facet").querySelectorAll('input[type="range"]')],s=t[0]?[t[0].min,t[0].max]:[],i=t.map((e=>e.value));return i.filter((e=>!s.includes(e))).length||i[0]===i[1]?i:[]}}const f={},m=(Math.max,Math.min);function b(e,t,s){let i,n,r,a,o,l,c=0,d=!1,h=!1,u=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT);function p(t){let s=i,r=n;return i=n=void 0,c=t,a=e.apply(r,s),a}function g(e){let s=e-l;return void 0===l||s>=t||s<0||h&&e-c>=r}function f(){const e=Date.now();if(g(e))return b(e);o=setTimeout(f,function(e){let s=t-(e-l);return h?m(s,r-(e-c)):s}(e))}function b(e){return o=void 0,u&&i?p(e):(i=n=void 0,a)}function y(){let e=Date.now(),s=g(e);if(i=arguments,n=this,l=e,s){if(void 0===o)return function(e){return c=e,o=setTimeout(f,t),d?p(e):a}(l);if(h)return o=setTimeout(f,t),p(l)}return void 0===o&&(o=setTimeout(f,t)),a}return t=Number(t)||0,"object"==typeof s&&(d=!!s.leading,u="trailing"in s?!!s.trailing:u),y.cancel=function(){void 0!==o&&clearTimeout(o),c=0,i=l=n=o=void 0},y}class y extends g{isLoadingMore(){return this.hasParams(this.loadMoreSlug)}isLoadingPage(){return this.hasParams(this.loadPageSlug)}pushState(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"push";if(this.history){"scrollRestoration"in history&&(window.history.scrollRestoration="manual"),e=this.getQueryString(),e=""!==e?"?"+e:"",e+=window.location.hash;try{window.history[`${t}State`]({WP_Grid_Builder:this.options.id},null,window.location.pathname+e)}catch(e){}}}formData(e){const t=new FormData,s=this.getSettings();return this.emit("fetch",[s,e]),this.isRestAPI?JSON.stringify(s):(t.append("wpgb",JSON.stringify(s)),t)}getEndPoint(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"render",s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return s=s&&this.getQueryString(),e=this.isRestAPI?wpgb_settings.restUrl.replace("action=action","action="+t):(this.options.ajaxUrl||wpgb_settings.ajaxUrl).replace("wpgb-ajax=action","wpgb-ajax="+t),e+(s?"&"+s:"")}getSettings(){const e=window.wpgb_preview_settings||{},t=window.wpgb_settings||{},s=Object.keys(this.facets);return e.is_main_query=this.options.isMainQuery,e.main_query=t.mainQuery,e.permalink=t.permalink,e.facets=s.map(Number),e.lang=t.lang,e.id=this.options.id,this.options.isShadow&&(e.is_shadow=this.options.isShadow),this.options.isGutenberg&&(e.is_gutenberg=!0),this.options.isPreview&&(e.is_preview=!0),this.options.isTemplate&&(e.is_template=this.options.isTemplate,e.source_type=this.options.sourceType,e.query_args=this.options.queryArgs,e.render_callback=this.options.renderCallback,e.noresults_callback=this.options.noresultsCallback),this.options.postId&&(e.post_id=this.options.postId),e}fetch(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"refresh";this.abort(),this.loadContent(e)}loadContent=b((e=>{this.emit("refresh"),this.loading(!0,e),this.xhr=new XMLHttpRequest,this.xhr.onload=t=>this.onLoad(t,e),this.xhr.open("POST",this.getEndPoint(e)),this.isRestAPI&&(this.xhr.setRequestHeader("Content-Type","application/json;charset=UTF-8"),wpgb_settings?.restNonce&&this.xhr.setRequestHeader("X-WP-Nonce",wpgb_settings.restNonce)),this.xhr.send(this.formData(e))}),150,{leading:!0});abort(){this.xhr&&this.xhr.abort(),delete this.xhr}loading(e,t){const{facets:s}=this;if(("add"!==(e=e?"add":"remove")||"render"!==t&&!this.isLoadingMore())&&(!this.options.isShadow&&this.element.classList[e]("wpgb-loading"),"add"!==e||!this.isLoadingPage()))for(let t in s){let i=s[t];["pagination","load_more","search"].includes(i.type)||i.forEach((t=>{let{holder:s}=t;return s.classList[e]("wpgb-loading")}))}}onLoad(e,t){const{facets:s,posts:i,total:n}=this.getResponse(e.target.responseText),r=this.isLoadingMore()?"append":"replace";this.loading(),this.render(s),this.emit("loaded",[this.facets]),"refresh"===t?(this.appendItems(i,r),this.annonceResults(n)):(this.preFilter(),this.emit("prefilter")),f[this.element.facetGUID]=this.getQueryString()}getResponse(e){let t={};try{t=JSON.parse(e)}catch(s){const i=e.match(/\{"(facets|posts)".*\}/i);if(i&&i[0])try{t=JSON.parse(i[0])}catch(e){console.error(e),t={}}else console.error("No valid content was detected in the response.")}return this.emit("fetched",[t]),t}annonceResults(e){if(this.isLoadingPage()||this.isLoadingMore())return;let t;const s=document.createElement("div"),{resultMsg:i}=wpgb_settings;void 0!==e&&i&&(t=i?.plural,1===parseInt(e)?t=i.singular:parseInt(e)||(t=i.none),s.classList.add("wpgb-sr-only"),s.setAttribute("role","status"),s.setAttribute("aria-live","polite"),s.setAttribute("aria-atomic",!0),document.body.appendChild(s),setTimeout((()=>s.textContent=t.replace("%d",e)),100),setTimeout((()=>document.body.removeChild(s)),1e3))}appendItems(e,t){if(!e)return;const s=document.createRange();s.selectNodeContents(s.createContextualFragment("<template>").lastChild);const i=s.createContextualFragment(e);if(this.options.isTemplate)return void this.appendTemplate(i,e,t);if(!(e=i.querySelectorAll(".wpgb-card")).length)return;const n=this.element.querySelector(".wpgb-viewport > div");n&&(n.appendChild(i),this.emit("appended",[e,t]))}appendTemplate(e,t,s){const{itemSelector:i}=this.options;let{element:n}=this;if(t=i?e.querySelectorAll(i):[...e.children],i&&"append"===s||this.options.customContent){const s=n.querySelector(i);e=document.createDocumentFragment(),t.forEach((t=>e.appendChild(t))),s&&(n=s.parentElement)}if("replace"===s)for(;n.firstChild;){let e=n.firstChild;n.removeChild(e),e=null}n.appendChild(e),this.emit("appended",[t,s])}}const w="_";class v extends y{getURLParams(){const e=window.location.search.slice(1);if(this.params=new URLSearchParams(e),this.history)return;const t=this.params.get("s");this.params=new URLSearchParams(""),t&&this.params.set("s",t)}getParams(e){const t={},s=this.params.entries();for(let i of s){let s=i[0].substring(1),n=i[1].split(",");if(i[0].charAt(0)===w){if(e===s)return n;t[s]=n}}return e?[]:t}getParam(e){return(this.params.get(w+e)||"").split(",")}hasParams(e){return e&&this.params.has(w+e)}setParams(e,t){t=(t=this.validateParams(t)).filter(((e,t,s)=>s.indexOf(e)===t)),this.updateParams(e,t)}deleteParams(e,t){(t=this.validateParams(t)).length&&(t=this.getParam(e).filter((e=>t.indexOf(e)<0))),this.updateParams(e,t)}diffParams(e,t){let s=this.getParam(e);(t=this.validateParams(t)).forEach((e=>{let t=s.indexOf(e);-1===t?s.push(e):s.splice(t,1)})),this.updateParams(e,s)}updateParams(e,t){e=w+e,(t=t.filter((e=>e.trim().length)))&&t.length?this.params.set(e,t.join(",")):this.params.delete(e)}validateParams(e){return Array.isArray(e)?(e=e.filter((e=>"string"==typeof e||"number"==typeof e&&!isNaN(e)))).map(String):[]}getQueryString(){return this.params.toString()}}class S extends v{query(){const e=`.wpgb-facet[data-grid="${CSS.escape(this.options.id)}"]`,t=document.querySelectorAll(e);this.facets={},t.forEach((e=>{let t=parseInt(e.dataset.facet,10),s=e.closest(".wp-grid-builder");t<1||s&&s!==this.element||(this.facets.hasOwnProperty(t)||(this.facets[t]=[]),this.facet={id:t,init:!0,holder:e},this.facets[t].push(this.facet),WP_Grid_Builder.emit("prerender",[e,this.facet,this]))})),delete this.facet}preFilter(){const{facets:e}=this;if(!this.getQueryString()){for(let t in e){let s=e[t][0],i=s.selected;i&&i.length&&this.setParams(s.slug,i)}this.pushState("replace")}}getFacet(e){const{facets:t}=this;let s=[];if(!Object.keys(t).length)return{};if(!e)return t;if(!isNaN(parseFloat(e))&&isFinite(e))return t.hasOwnProperty(e)&&(s=t[e]),s;for(let s in t)if(t.hasOwnProperty(s)&&t[s][0].slug===e)return t[s];return s}hasFacet(e){return!!e&&!!this.getFacet(e).length}render(e){this.setFocused();for(let t in e)e.hasOwnProperty(t)&&this.facets.hasOwnProperty(t)&&this.facets[t].forEach(((s,i)=>{this.facet=Object.assign(s,e[t]),this.facet.html&&this.facet.rendered||(this.facet.holder.classList.add("wpgb-notransitions"),this.remove(this.facet.holder),this.append(this.facet.holder),requestAnimationFrame((()=>this.getFacet(t)[i].holder.classList.remove("wpgb-notransitions")))),"reset"===this.facet.type&&(this.facet.rendered=!!this.facet.html),this.emit("render",[this.facet.holder,this.facet]),delete this.facet.focused,this.facets[t][i]=this.facet,this.initLoader()}));delete this.facet}setFocused(){const e=document.activeElement;this.isFacet(e)&&(this.facet.focused=e)}remove(e){for(;e.firstChild;)e.removeChild(e.firstChild)}append(e){const t=document.createRange().createContextualFragment(this.facet.html);e.hidden=""===this.facet.html,e.appendChild(t)}initLoader(){const{type:e,settings:t,disabled:s,holder:i}=this.facet,{layout:n}=this.options;"load_more"===e&&(this.loader=i.querySelector(".wpgb-load-more"),this.loader&&(this.loader.disabled=s||!1),this.loader&&!wpgb_settings.renderBlocks&&"onscroll"===t.load_more_event&&(this.loader.onScroll=!0,"horizontal"!==n&&(this.unObserve(),this.observe())))}}const _=class extends S{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.options=t,this.element=e,this.autoRefresh=!0,this.isRestAPI=!t?.ajaxUrl&&"rest_api"===wpgb_settings?.endpoint,this.query(),Object.keys(this.facets).length&&(this.setInstance(),this.canPush())}setInstance(){this.element.facetGUID||(this.facetGUID=Object.keys(f).length+1,this.element.facetGUID=this.facetGUID)}init(){const{facetGUID:e}=this.element;if(f[e]){const t=f[e].toString();this.params=new URLSearchParams(t)}else this.getURLParams(),this.getQueryString()&&this.pushState("replace");Object.keys(this.facets).length&&(this.bindEvents(),this.emit("init",[this.facets]),this.fetch("render"))}destroy(){this.abort(),this.unObserve(),this.bindEvents(!1),this.loading(!1),delete this.loader,delete this.loadMoreSlug,delete this.loadPageSlug}canPush(){this.history=window.wpgb_settings&&wpgb_settings.history}refresh(){this.autoRefresh&&(this.unsetLoaders(),this.pushState(),this.fetch())}reset(e){const t=this.getQueryString();t&&(e&&e?.length||(e=(e=Object.keys(this.facets)).map((e=>this.facets[e][0]&&this.facets[e][0].slug))),"string"==typeof e&&(e=[e]),e.forEach((e=>this.deleteParams(e))),t!==this.getQueryString()&&(this.emit("reset",[e]),this.unsetLoaders(),this.pushState(),this.fetch()))}unsetLoaders(){const e=["pagination","load_more"];let{facets:t}=this;t=Object.keys(t).map((s=>{let i=t[s][0];return i&&e.includes(i.type)&&i.slug})),t.forEach((e=>e&&this.deleteParams(e)))}loadMore(){if(this.xhr&&4!==this.xhr.readyState)return;const{slug:e,settings:t,holder:s}=this.facet,i=s.querySelector(".wpgb-load-more"),{width:n}=i&&i.getBoundingClientRect();if(!i)return;i.classList.add("wpgb-loading"),t.loading_text&&(i.style.minWidth=`${n}px`,i.textContent=t.loading_text);let r=(t.number+t.offset).toString();this.loadMoreSlug=e,this.deleteParams(this.loadPageSlug),this.setParams(e,[r]),this.emit("change",[e,[r]]),this.fetch()}loadPage(e){const{slug:t}=this.facet;this.getParam(t)[0]!==(e=e<2?"":e)&&(this.loadPageSlug=t,this.deleteParams(this.loadMoreSlug),this.setParams(t,[e]),this.emit("change",[t,[e]]),this.pushState(),this.fetch())}},P="undefined"!=typeof Map&&new Map;let x={};function E(e){return P.has(e.instance)}function A(e,t){e.instance=function(e){return x[e.type]||(x[e.type]=0),`${e.type}-${++x[e.type]}`}(e),P.set(e.instance,t)}function q(e){return P.get(e.instance)}function L(e){P.delete(e.instance)}function k(e){"date"===this.facet.type&&(this.facet.html?C.apply(this,[e,this.facet]):D.apply(this,[e,this.facet]))}function C(e,t){e.querySelector(".wpgb-date-facet")&&(t.rendered?G(e,t):R.apply(this,[e,t]),t.rendered=!0,O(t))}function O(e){if(!E(e))return;const t=q(e),s=e.holder.querySelector(".wpgb-clear-button");t?._input&&(t._input.disabled=e.disabled??!1),s&&(s.disabled=e.disabled??!1)}function R(e,t){WP_Grid_Builder.Date((s=>{const i=this.getFacet(t.id),n=e.querySelector("input.wpgb-input"),r=document.activeElement===n;if(!i.length||!n)return void D.apply(this,[e,t]);t.selected=i[0].selected||t.selected,t.settings.locale=t.settings.locale.substring(0,2),t.settings.locale="ca"===t.settings.locale?"cat":t.settings.locale,t.settings.locale="el"===t.settings.locale?"gr":t.settings.locale,this.emit("date.options",[t.settings,t]),s=s(n,t.settings);const a=e.className.split(" ").find((e=>e.includes("wpgb-style-")));a&&s?.calendarContainer?.classList?.add?.(a),r&&s._input&&s._input.focus(),A(t,s),function(e,t){const s=e.querySelector(".wpgb-clear-button"),i=e.querySelector("input"),n=q(t),{mode:r}=n.config;let a="";n.config.onOpen.push((()=>a=n.selectedDates)),n.config.onClose.push((()=>{if("range"===r&&1===n.selectedDates.length){let e=a.map((e=>n.formatDate(e,"Y-m-d")));requestAnimationFrame((()=>n.setDate(e)))}})),i.addEventListener("change",(e=>{if("range"===r&&1===n.selectedDates.length)return e.preventDefault(),void e.stopPropagation();let t=n.selectedDates.map((e=>n.formatDate(e,"Y-m-d")));t=t.filter(((e,t,s)=>s.indexOf(e)===t)),i.value="range"===r?t.length?t:"":t.length?t[0]:"",s.hidden=!t.length})),s&&s.addEventListener("click",(e=>{e.preventDefault(),n.clear(),n.altInput.focus(),n.close()}))}(e,t),G(e,t),O(t),this.emit("date.init",[s,t])}))}function D(e,t){E(t)&&(q(t).destroy(),L(t),this.emit("date.destroy",[t])),t.rendered=!1}function G(e,t){if(!E(t))return;const{selected:s}=t,i=e.querySelector(".wpgb-clear-button"),n=q(t);t.settings.minDate&&(n.set("minDate",[t.settings.minDate,...s].reduce(((e,t)=>e<t?e:t))),n.set("maxDate",[t.settings.maxDate,...s].reduce(((e,t)=>e>t?e:t))));const r=new Date,a=n.config.minDate||r,o=n.config.maxDate||r;n.setDate(s),s&&s[0]?n.jumpToDate(s[0]):r>=new Date(a)&&r<=new Date(o)?n.jumpToDate(r):r<new Date(a)?n.jumpToDate(a):r>new Date(o)&&n.jumpToDate(o),i&&(i.hidden=!(s&&s.length))}function B(e){"range"===this.facet.type&&(this.facet.html?F.apply(this,[e,this.facet]):W.apply(this,[e,this.facet]))}function F(e,t){e.querySelector(".wpgb-range-facet")&&(t.rendered?function(e,t){const s=q(t),i=document.createRange().createContextualFragment(t.html),n=i.querySelectorAll(".wpgb-range-facet input"),r=e.querySelectorAll(".wpgb-range-facet input"),a=["step","min","max","value"];if(r.length&&n.forEach(((e,t)=>a.forEach((e=>r[t][e]=n[t][e])))),!s)return;s.previous=[s.inputs[0].value,s.inputs[1].value],s.setValues(),s.getSliderSize(),s.updateSlider()}(e,t):I.apply(this,[e,t]),t.rendered=!0,function(e){if(!E(e))return;const t=q(e);e.disabled?t.disable():t.enable()}(t))}function I(e,t){WP_Grid_Builder.Range((s=>{const i=this.getFacet(t.id),n=e.querySelectorAll('[type="range"]'),r=e.querySelector(".wpgb-range-facet"),a=e.querySelector(".wpgb-range-facet-loader"),o=wpgb_settings.range;i.length&&r?(n?.[0]&&(n[0].disabled=t.disabled??!1),n?.[1]&&(n[1].disabled=t.disabled??!1),t.selected=i[0].selected||t.selected,t.settings.minLabel=o?o.minLabel:"",t.settings.maxLabel=o?o.maxLabel:"",this.emit("range.options",[t.settings,t]),s=s(r,t.settings),A(t,s),a&&a.parentElement.removeChild(a),this.emit("range.init",[s,t])):W.apply(this,[e,this.facet])}))}function W(e,t){E(t)&&(q(t).destroy(),L(t),this.emit("range.destroy",[t])),t.rendered=!1}function N(e){"number"===this.facet.type&&(this.facet.html?(T.apply(this,[e,this.facet]),this.facet.rendered=!0):this.facet.rendered=!1)}function T(e,t){const s=e.querySelectorAll('input[type="number"]');if(!s.length)return;const i=e.querySelector("button.wpgb-number-submit");if(U.apply(this,[s,t]),i&&j.apply(this,[t,s,i]),!t.rendered){if(i)return j.apply(this,[t,s,i]),i.addEventListener("click",(e=>$.apply(this,[e,t,s]))),s.forEach((e=>e.addEventListener("change",(e=>e.stopPropagation())))),s.forEach((e=>e.addEventListener("input",b((()=>j.apply(this,[t,s,i])),50)))),void s.forEach((e=>e.addEventListener("keydown",(e=>"Enter"===e.key&&$.apply(this,[e,t,s])))));s.forEach((e=>e.addEventListener("change",(e=>$.apply(this,[e,t,s]))))),s.forEach(((e,i)=>{e.addEventListener("input",(e=>M.apply(this,[e,t,i]))),e.addEventListener("input",b((e=>$.apply(this,[e,t,s])),350))}))}}function j(e,t,s){const i=this.getParams(e.slug),n=J(t);s.disabled=H(n,i)}function M(e,t,s){this.getParams(t.slug)[s]!==e.target.value.trim()&&this.abort()}function U(e,t){const s=document.createRange().createContextualFragment(t.html).querySelectorAll('input[type="number"]');e.forEach(((e,i)=>{e.min=t.settings.min,e.max=t.settings.max,e.step=t.settings.step,e.value=s[i].value,e.placeholder=s[i].placeholder,e.disabled=t.disabled??!1}))}function $(e,t,s){const i=J(s),n=this.getParams(t.slug);e.stopPropagation(),H(i,n)||(this.updateParams(t.slug,i.map((e=>e.toString()))),this.emit("change",[t.slug,i]),this.refresh())}function J(e){let t=[...e].map((e=>e.value||"_"));return t.filter((e=>"_"!==e)).length||(t=[]),t}function H(e,t){return!e.length&&!t.length||e.length===t.length&&(1===e.length&&e[0]===t[0]||2===e.length&&e[0]===t[0]&&e[1]===t[1])}window.WP_Grid_Builder.on("prerender",(function(e,t,s){e.querySelector(".wpgb-date-facet")&&WP_Grid_Builder.Date()})),window.WP_Grid_Builder.on("init",(function(e){e.facets.on("render",k)})),window.WP_Grid_Builder.on("prerender",(function(e,t,s){e.querySelector(".wpgb-range-facet")&&WP_Grid_Builder.Range()})),window.WP_Grid_Builder.on("init",(function(e){e.facets.on("render",B)})),window.WP_Grid_Builder.on("init",(function(e){e.facets.on("render",N)}));s(4705),s(4828),s(4540);function Q(e){"search"===this.facet.type&&(this.facet.html?(V.apply(this,[e,this.facet]),this.facet.rendered=!0):this.facet.rendered=!1)}function V(e,t){const s=e.querySelector('input[type="search"]');if(!s)return;if(t.rendered||Y.call(this,s,t),function(e,t){const s=e.value.trim(),i=t.selected.join(),n=Z(t);s!==i&&(e.value=i);n&&(n.hidden=!i.length,n.disabled=t?.disabled??!1);e.disabled=t?.disabled??!1}(s,t),!t.settings.instant_search||t.rendered)return;const i=isNaN(t?.settings?.search_debounce)||""===t?.settings?.search_debounce?350:t?.settings?.search_debounce;s.addEventListener("input",(e=>X.apply(this,[e,t]))),s.addEventListener("input",b((e=>z.apply(this,[e,t])),i)),s.addEventListener("change",(e=>e.stopPropagation()))}function X(e,t){this.getParams(t.slug).join().trim()!==e.target.value.trim()&&this.abort()}function z(e,t){const s=this.getParams(t.slug).join().trim(),i=e.target.value.trim();if(s===i)return void e.stopPropagation();const n=Math.max(1,t?.settings?.search_min_length||1);i&&i?.replace?.(/^\s+/,"").length<n||(this.setParams(t.slug,[i]),this.emit("change",[t.slug,i?[i]:[]]),this.refresh())}function Y(e,t){const s=Z(t);s&&(e.addEventListener("input",(()=>s.hidden=!e.value.length)),s.addEventListener("mousedown",(e=>e.preventDefault())),s.addEventListener("click",(i=>{e.value="",s.hidden=!0,e.focus(),z.call(this,i,t)})))}function Z(e){return e.holder.querySelector(".wpgb-clear-button")}function K(e){"sort"!==this.facet.type&&"select"!==this.facet.type&&"per_page"!==this.facet.type||(this.facet.html?ee.apply(this,[e,this.facet]):se.apply(this,[e,this.facet]))}function ee(e,t){const s=e.querySelector("select.wpgb-combobox");t.rendered||!s?function(e,t){const{settings:s,html:i}=t,n=q(t),r=n?n.element:e.querySelector("select.wpgb-select"),a=document.createRange().createContextualFragment(i).querySelectorAll("select option"),o=[];Array.from(r.options).forEach((e=>r.remove(e))),a.forEach(((e,t)=>{e.selected&&o.push(e.value),r.add(e,t)})),r.multiple||(r.value=o[0]||"");r.disabled=t.disabled??!1,n&&(!s.async&&n.Data.parse(),s.async&&n.close(),n.DOM.clearDropDown(),t.disabled?n.disable():n.enable(),requestAnimationFrame((()=>n.update())))}(e,t):te.apply(this,[e,t]),t.rendered=!0}function te(e,t){WP_Grid_Builder.Select((s=>{const i=this.getFacet(t.id),n=e.querySelector("select.wpgb-combobox");if(!i.length||!n)return void se.apply(this,[e,this.facet]);t.selected=i[0].selected||t.selected,n.disabled=t.disabled??!1,this.emit("select.options",[t.settings,t]),(s=s(n,ie.apply(this,[e,t]))).init();const r=e.className.split(" ").find((e=>e.includes("wpgb-style-")));r&&s?.DOM?.dropDown?.classList?.add?.(r),A(t,s),this.emit("select.init",[s,t])}))}function se(e,t){E(t)&&(q(t).destroy(),L(t),this.emit("select.destroy",[t])),t.rendered=!1}function ie(e,t){let s={messages:{...wpgb_settings.combobox}};if(!t||!t.settings)return s;if(s.messages.noResults=t.settings.no_results,s.messages.loading=t.settings.loading,s.messages.search=t.settings.search,s.searchable=t.settings.searchable,s.clearable=t.settings.clearable,s.clearLabel=s.messages.clearLabel,s.toggleLabel=s.messages.toggleLabel,t.settings.async){const t=this.getEndPoint("search",!1).split(/[?#]/);s.async={url:t[0],contentType:this.isRestAPI?"application/json;charset=UTF-8":"",header:{"X-WP-Nonce":this.isRestAPI?wpgb_settings.restNonce:""},data:()=>{const e=this.getParams(),s=t[1]&&new URLSearchParams(t[1]),i={};for(let e of s.entries())i[e[0]]=e[1].split(",");for(var n in e)i["_"+n]=e[n];return i},post:t=>{const s=new FormData,i=this.getSettings();return i.search={facet:Number(e.getAttribute("data-facet")),string:t},this.isRestAPI?JSON.stringify(i):(s.append("wpgb",JSON.stringify(i)),s)},response:e=>{const t=[];return e.length&&e.forEach((e=>{const s=!1!==e.count?" ("+e.count+")":"";t.push({value:e.facet_value,textContent:e.facet_name+s,disabled:e.disabled})})),t}}}return s}window.WP_Grid_Builder.on("init",(function(e){e.facets.on("render",Q)})),window.WP_Grid_Builder.on("prerender",(function(e,t,s){e.querySelector("select.wpgb-combobox")&&WP_Grid_Builder.Select()})),window.WP_Grid_Builder.on("init",(function(e){e.facets.on("render",K)}));s(1542),s(957);const ne="undefined"!=typeof Map&&new Map;function re(e){"autocomplete"===this.facet.type&&(this.facet.html?ae.apply(this,[e,this.facet]):de.apply(this,[e,this.facet]))}function ae(e,t){t.rendered?function(e,t){const s=e.querySelector('input[type="search"]');if(!s)return;s.value=t.selected.join(),ce(t)}(e,t):oe.apply(this,[e,t]),t.rendered=!0,function(e){if(!E(e))return;const t=q(e);e.disabled?t.disable():t?.element.disabled&&t.enable()}(t)}function oe(e,t){WP_Grid_Builder.AutoComplete((s=>{const i=this.getFacet(t.id),n=e.querySelector('input[type="search"]');if(!i.length||!n)return void de.apply(this,[e,this.facet]);const r=he.apply(this,[e,t]);t.selected=i[0].selected||t.selected,n.disabled=t.disabled??!1,this.emit("autocomplete.options",[r,t]),s=s(n,r),A(t,s),this.emit("autocomplete.init",[s,t]);const a=e.className.split(" ").find((e=>e.includes("wpgb-style-")));a&&s?.components?.Menu?.element?.classList?.add?.(a),n.addEventListener("change",(e=>e.stopPropagation())),n.addEventListener("keydown",(e=>{let{key:s}=e;const i=this.getParams(t.slug).join();"Enter"===s&&i!==n.value&&(le.call(this,t.slug,n.value),ce(t))}))}))}function le(e,t){this.getParams(e).join()!==t&&(this.setParams(e,[t]),this.emit("change",[e,[t]]),this.refresh())}function ce(e){if(!E(e))return;const t=q(e);t.abort(),t.update(),t.close()}function de(e,t){E(t)&&(q(t).destroy(),L(t),this.emit("autocomplete.destroy",[t])),t.rendered=!1}function he(e,t){const{isRestAPI:s}=this,{settings:i}=t,n=b((function(e,t,i,n,r){n.onload=e=>{let{responseText:t}=e.target;try{t=JSON.parse(t)}catch(e){t=[]}t=t.map((e=>({...e,value:e.facet_name,label:e.facet_name}))),ne.set(i,t),r(t)},n.open("POST",e),s&&(n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),wpgb_settings?.restNonce&&n.setRequestHeader("X-WP-Nonce",wpgb_settings.restNonce)),n.send(t)}),isNaN(t?.settings?.acplt_debounce)||""===t?.settings?.acplt_debounce?350:t?.settings?.acplt_debounce);let r;return{loader:!0,messages:wpgb_settings.autocomplete,minLength:i.acplt_min_length,matchAll:i.acplt_match_all,autoFocus:i.acplt_auto_focus,clearLabel:wpgb_settings.autocomplete.clearLabel,highlighter:!!i.acplt_highlight&&document.createElement("mark"),filterResults:()=>!0,sortResults:!!i.acplt_relevance&&((e,t)=>e.disabled-t.disabled||e.index-t.index||e.label.localeCompare(t.label)||e.label.length-t.label.length),source:(e,i)=>{e=e.trim();const a=this.getEndPoint("search"),o=this.getSettings(),l=function(e,t,s,i){const n=new FormData;if(s.search={facet:t.id,string:e},i)return JSON.stringify(s);return n.append("wpgb",JSON.stringify(s)),n}(e,t,o,s),c=function(e,t,s,i){e.params=t;for(const t in e.params)t===s.slug?delete e.params[t]:e.params[t].sort();return e.search={facet:s.id,string:i},JSON.stringify(e)}(o,this.getParams(),t,e);r&&r.abort(),ne.has(c)?i(ne.get(c)):(r=new XMLHttpRequest,n(a,l,c,r,i))},renderItem:(e,t)=>{if(e.disabled&&t.setAttribute("aria-disabled",!0),!1!==e.count){const t=" ("+e.count+")";"string"==typeof e.content?e.content+=t:e.content.append(document.createTextNode(t))}return e.content},onSelect:e=>le.call(this,t.slug,e.label),onClear:()=>le.call(this,t.slug,""),onAbort:()=>{r&&r.abort(),n?.cancel?.()}}}window.WP_Grid_Builder.on("prerender",(function(e,t,s){e.querySelector(".wpgb-autocomplete-facet")&&WP_Grid_Builder.AutoComplete()})),window.WP_Grid_Builder.on("init",(function(e){e.facets.on("render",re)}));s(694);let ue=0;WP_Grid_Builder.unsupported?function(){const e=document.querySelectorAll(".wpgb-facet"),t=document.querySelectorAll(".wpgb-sidebar");e&&e.forEach((e=>{let t=e.firstElementChild;t&&"wpgb-pagination-facet"!==t.className?e.style.display="none":e.classList.remove("wpgb-loading")})),t&&t.forEach((e=>e.parentElement.removeChild(e)))}():function(){const t=wpgb_settings.hasGrids;WP_Grid_Builder.Facets=(e,t)=>new _(e,t),WP_Grid_Builder.Range=(e,t)=>{new n("wpgb-range",(()=>e&&e(WP_Grid_Builder.vendors.range,t)))},WP_Grid_Builder.Date=(e,t)=>{new n("wpgb-date-css"),new n("wpgb-date",(()=>e&&e(WP_Grid_Builder.vendors.date,t)))},WP_Grid_Builder.Select=(e,t)=>{new n("wpgb-select",(()=>e&&e(WP_Grid_Builder.vendors.select,t)))},WP_Grid_Builder.AutoComplete=(e,t)=>{new n("wpgb-autocomplete",(()=>e&&e(WP_Grid_Builder.vendors.autocomplete,t)))},t?e("wpgb.facets.loaded"):(WP_Grid_Builder.instantiate=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.instances[++ue]=new u(e,t)},function(e){if("complete"===document.readyState||"interactive"===document.readyState)return e();document.addEventListener("DOMContentLoaded",e)}((()=>e("wpgb.loaded"))))}()})()})();