jQuery((function(e){if(e(".ywpar_back_button").length>0){var t=e(".ywpar_back_button");t.closest(".wrap").prepend(t),t.addClass("show")}const n=function(){if(e('input[name="ywpar_enable_points_upon_sales"]').length){const t="yes"===e('input[name="ywpar_enable_points_upon_sales"]:checked').val()?"inherit":"none";e(".yith-plugin-fw__panel__content__page--options form > div.yith-plugin-fw__panel__section:nth-child(3)").css("display",t)}};function i(t){var n=[];return e(t).each((function(){var t=e(this).children("option:selected").val();void 0!==t&&typeof n[t]!==t&&n.push(e(this).children("option:selected").val())})),n}jQuery(document).on("change",'input[name="ywpar_enable_points_upon_sales"]',n),n(),e("#ywpar_min_percentual_discount, #ywpar_max_percentual_discount,#ywpar_percentage_points_to_earn").after('<span class="ywpar_type_sign">%</span>'),e("#ywpar_fixed_points_to_earn").after('<span class="ywpar_type_sign">'+e("#ywpar_fixed_points_to_earn").data("sign")+"</span>"),e(document).on("change",'input[name="is_rule_scheduled"]',(function(){"scheduled"===e(this).val()?e(".ywpar_is_rule_scheduled .description").hide():e(".ywpar_is_rule_scheduled .description").show()})),e(document).on("click",".ywpar-rule-status input",(function(){var t=e(this),n=t.closest(".yith-plugin-ui"),i={post_id:n.data("id"),security:n.data("nonce"),status:t.is(":checked")?"yes":"no",action:"ywpar_change_status_to_earning_rule"};e.ajax({type:"POST",data:i,success:function(e){e.error&&console.log(e.error)},url:yith_ywpar_panel.ajax_url})})),e(document).on("click",".ywpar-rule-redeeming-status input",(function(){var t=e(this),n=t.closest(".yith-plugin-ui"),i={post_id:n.data("id"),security:n.data("nonce"),status:t.is(":checked")?"yes":"no",action:"ywpar_change_status_to_redeeming_rule"};e.ajax({type:"POST",data:i,success:function(e){e.error&&console.log(e.error)},url:yith_ywpar_panel.ajax_url})})),e(document).on("click",".ywpar-lb-status input",(function(){var t=e(this),n=t.closest(".yith-plugin-ui"),i={post_id:n.data("id"),security:n.data("nonce"),status:t.is(":checked")?"yes":"no",action:"ywpar_change_status_to_level"};e.ajax({type:"POST",data:i,success:function(e){e.error&&console.log(e.error)},url:yith_ywpar_panel.ajax_url})})),e(document).on("click",".ywpar-banner-status input",(function(){var t=e(this),n=t.closest(".yith-plugin-ui"),i={post_id:n.data("id"),security:n.data("nonce"),status:t.is(":checked")?"yes":"no",action:"ywpar_change_status_to_banner"};e.ajax({type:"POST",data:i,success:function(e){e.error&&console.log(e.error)},url:yith_ywpar_panel.ajax_url})})),e(".form-table").find("[data-desc]").each((function(){var t=e(this),n=t.attr("data-desc").split(",");"number"===t.attr("type")?t.after('<span class="ywpar_type_sign">'+n[0]+"</span>"):t.find("input").after('<span class="ywpar_type_sign">'+n+"</span>")})),e("#ywpar_points_type_conversion input").on("click",(function(){"override"!==e(this).val()?e("#ywpar_earn_points_conversion_rate-container").each((function(){e(this).find("input").each((function(){e(this).attr("required",!1)}))})):e("#ywpar_earn_points_conversion_rate-container").each((function(){e(this).find("input").each((function(){e(this).attr("required",!0)}))}))})),e("#ywpar_affiliates_enabled").on("change",(function(){"no"===e(this).val()?e(this).closest(".yith-plugin-fw__panel__section__content").each((function(){e(this).find("input").each((function(){e(this).attr("required",!1)}))})):e(this).closest(".yith-plugin-fw__panel__section__content").each((function(){e(this).find("input").each((function(){e(this).attr("required",!0)}))}))})),e(".yith_woocommerce_points_and_rewards_panel_page").find("[data-deps]").each((function(){var t=e(this),n=(t.find("input"),t.closest(".yith-plugin-fw__panel__option").length>0?t.closest(".yith-plugin-fw__panel__option"):t.closest("tr")),i=t.attr("data-deps").split(","),o=t.attr("data-deps_value").split(","),a=[];"radio"!==e('[name="user_type"]').attr("type")&&(e(this).hasClass("ywpar_user_plans_list")||e(this).hasClass("ywpar_user_levels_list"))||e.each(i,(function(t,i){"radio"!==e('[name="user_type"]').attr("type")&&"ywpar_user_type"===i||e('[id="'+i+'"]').on("change",(function(){var i=this.value,r="";("radio"!=this.type||e(this).is(":checked"))&&("checkbox"==this.type&&(i=e(this).is(":checked")?"yes":"no"),r=(r=o[t]+"").split("|"),a[t]=-1!==e.inArray(i,r),-1===e.inArray(!1,a)?n.show():n.hide())})).change()}))})),"radio"!==e('[name="user_type"]').attr("type")&&(e(document).on("change","#ywpar_user_type-levels",(function(){e(this).is(":checked")?e(".form-table").find(".ywpar_user_levels_list").show():e(".form-table").find(".ywpar_user_levels_list").hide()})),e(document).on("change","#ywpar_user_type-membership",(function(){e(this).is(":checked")?e(".form-table").find(".ywpar_user_plans_list").show():e(".form-table").find(".ywpar_user_plans_list").hide()})),e("#ywpar_user_type-levels").change(),e("#ywpar_user_type-membership").change()),e(document).on("click",".options-role-conversion .ywpar-add-row, .options-role-percentage-conversion .ywpar-add-row",(function(){var t=e(this),n=t.closest(".yith-plugin-fw-field-wrapper"),o=t.parent().find('.role-conversion-options[data-index="1"]'),a=parseInt(o.data("index")),r=o.clone(),s=n.find(".role-conversion-options"),p=(o.parent().find(".ywpar-add-same-row").clone(),1);s.each((function(){var t=e(this).data("index");t>p&&(p=t)}));var c=p+1;r.attr("data-index",c),r.find("[name*='role_conversion']").each((function(){var t=e(this),n=t.attr("name"),i=t.attr("id"),o=n.replace("[role_conversion]["+a+"]","[role_conversion]["+c+"]"),r=i.replace("[role_conversion]["+a+"]","[role_conversion]["+c+"]");t.attr("name",o),t.attr("id",r),t.val("")})),r.find(".ywpar-remove-row").removeClass("hide-remove"),r.find(".chosen-container").remove();(t.parent().find(".role-conversion-options").hasClass("ywpar_redeem_roles")?i(".ywpar_redeem_roles select"):i(".ywpar_earn_roles select")).forEach((function(e){r.find('select.ywpar_role option[value="'+e+'"]').remove()})),t.before('<div class="role-conversion-options-container">'+r[0].outerHTML+'<div class="clear"></div></div>')})),e("#yith_woocommerce_points_and_rewards_points-extra form").on("click",".yith-plugin-fw__panel__option--onoff",(function(){e(this).closest(".yith-plugin-fw__panel__section__content").toggleClass("opened")})),e(document).on("click","#yith_woocommerce_points_and_rewards_points-extra .ywpar-add-row",(function(){var t=e(this),n=t.closest(".yith-plugin-fw-field-wrapper"),i=t.prev(".extrapoint-options"),o=parseInt(i.data("index")),a=i.clone(),r=n.find(".extrapoint-options"),s=1;i.find(".repeat").addClass("hide"),i.find(".repeat input").prop("checked",!1),r.each((function(){var t=e(this).data("index");t>s&&(s=t)}));var p=s+1;a.attr("data-index",p),a.find("[name*='list']").each((function(){var t=e(this),n=t.attr("name"),i=t.attr("id"),a=n.replace("[list]["+o+"]","[list]["+p+"]"),r=i.replace("[list]["+o+"]","[list]["+p+"]");t.attr("name",a),t.attr("id",r),t.val("")})),a.find(".ywpar-remove-row").removeClass("hide-remove"),a.find(".chosen-container").remove(),e(document).trigger("row-cloned",{clone:a}),t.before(a)}));var o=e(".yith-plugin-fw-options-extrapoints-membership-plans-field-wrapper");if(o.length>0){var a=o.find("select").first().find("option");e(document).on("row-cloned",(function(t,n){var i=n.clone;0!=e(i).closest("#ywpar_points_on_membership_plan-container").length&&(e(i).find("select").find("option").remove(),e.map(a,(function(t){e(i).find("select").append(new Option(t.text,t.value))})),e(".yith-plugin-fw-options-extrapoints-membership-plans-field-wrapper").find("select").each((function(t,n){null!=e(n).val()&&e(i).find('select option[value="'+e(n).val()+'"]').remove()})))}))}e(document).on("click","#yith_woocommerce_points_and_rewards_points .ywpar-remove-row",(function(){e(this).closest(".role-conversion-options").remove()})),e(document).on("click",".extrapoint-options .ywpar-remove-row",(function(){var t=e(this).closest(".extrapoint-options");previous=t.prev(),previous.find(".repeat").removeClass("hide"),t.remove()})),e(document).on("click",".options-role-conversion .ywpar-remove-row, .options-role-percentage-conversion .ywpar-remove-row",(function(){var t=e(this).closest(".role-conversion-options"),n=t.parent();t.remove(),0===n.find(".role-conversion-options").length&&n.remove()})),e("#yith_woocommerce_points_and_rewards_points-extra .form-table tr.onoff:first-child input.on_off").each((function(){"yes"===e(this).val()&&e(this).closest(".form-table").prev().trigger("click")})),e(document).on("change","#ywpar_banner_type",(function(){e(".ywpar_banner_title .forminp .description.precompiled").hide(),e(".ywpar_banner_subtitle .forminp .description.precompiled").hide(),"target"===e(this).val()?e(".description[data-ref="+e("#ywpar_banner_action_target_type").val()+"]").show():"get_points"===e(this).val()&&e(".description[data-ref="+e("#ywpar_banner_action_type").val()+"]").show()})),e(document).on("change","#ywpar_banner_action_target_type, #ywpar_banner_action_type",(function(){e(".ywpar_banner_title .forminp .description.precompiled").hide(),e(".ywpar_banner_subtitle .forminp .description.precompiled").hide(),e(".description[data-ref="+e(this).val()+"]").show()})),e("#ywpar_banner_type").change();var r=function(t,n){return n.children().each((function(){e(this).width(e(this).width())})),n},s=function(t){e.post(yith_ywpar_panel.ajax_url,{action:"ywpar_order_list_table",request:"sort",sorted:t}).done((function(e){}))};e.each([".post-type-ywpar-banner",".post-type-ywpar-earning-rule",".post-type-ywpar-redeeming-rule"],(function(t,n){e(n+" .wp-list-table  tbody tr").addClass("ui-state-default"),e(n+" .wp-list-table  tbody").sortable({placeholder:"ui-state-highlight",axis:"y",handle:".yith-plugin-fw__action-button--drag-action",helper:r,stop:function(){$sorted=e(n+" .wp-list-table").find('[name="post[]"]');var t=[];$sorted.each((function(n,i){t.push(e(i).val())})),s(t)}}).disableSelection()})),e("#ywpar_import_points").length&&e("#ywpar_import_points").closest("form").attr("enctype","multipart/form-data"),e("#file_import_csv_btn").on("click",(function(t){t.preventDefault(),e("#file_import_csv").click()})),e("#file_import_csv").on("change",(function(){var t=document.getElementById("file_import_csv").files[0].name;""!==t&&e("span.ywpar_file_name").html(t)})),e("button#ywpar_import_points").on("click",(function(t){t.preventDefault();var n=e("#type_action").val();e(".ywpar_safe_submit_field").val(n+"_points"),e(this).closest("form").submit()})),e(".ywpar_import_result").length&&setTimeout((function(){e(".ywpar_import_result").remove()}),3e3),e("#type_action").on("change",(function(){"import"===e(this).val()?(e("#yith_woocommerce_points_and_rewards_import_export .upload.file_import_csv").show(),e("#yith_woocommerce_points_and_rewards_import_export .radio.csv_import_action").show(),e("#ywpar_import_points").text(yith_ywpar_customer_panel.import_button_label)):(e("#yith_woocommerce_points_and_rewards_import_export .upload.file_import_csv").hide(),e("#yith_woocommerce_points_and_rewards_import_export .radio.csv_import_action").hide(),e("#ywpar_import_points").text(yith_ywpar_customer_panel.export_button_label))})),e("#type_action").change(),e("#ywpar_enable_rewards_points").on("change",(function(){var t=e(this),n=e("#plugin-fw-wc").find("h2").last();t.is(":checked")?n.show():n.hide()})).change(),e("#ywpar_apply_points_from_wc_points_rewards_btn").on("click",(function(t){t.preventDefault();var n=e("#ywpar_apply_points_from_wc_points_rewards_btn").closest(".forminp-yith-field");n.find(".response").remove(),e.ajax({type:"POST",url:yith_ywpar_panel.ajax_url,dataType:"json",data:"action=ywpar_apply_wc_points_rewards&security="+yith_ywpar_panel.apply_wc_points_rewards,success:function(e){n.append('<span class="response">'+e+"</span>")}})})),e("#post-query-submit,#posts-filter,#doaction, #ywpar_import_points, #ywpar_import_points, .yith-nav-tab-wrapper a, .yith-nav-sub-tab-wrapper a").on("click",(function(e){window.onbeforeunload=null}))}));