{"generator":"Code Snippets v3.6.8","date_created":"2025-06-13 05:51","snippets":[{"id":7,"name":"product variation on home page","code":"\/\/ Display Product Variations Below Title on Home Page Carousel\nadd_action( 'wp_footer', 'show_product_variations_in_carousel' );\nfunction show_product_variations_in_carousel() {\n    \/\/ Apply this only on the homepage\n    ?>\n    <script>\n        document.addEventListener('DOMContentLoaded', function () {\n            document.querySelectorAll('.uc_image_carousel_content_inside').forEach(function (productContainer) {\n                const productId = productContainer.querySelector('.woosq-btn')?.getAttribute('data-id');\n                \n                if (productId) {\n                    const data = new FormData();\n                    data.append('action', 'fetch_product_variations');\n                    data.append('product_id', productId);\n\n                    fetch('<?php echo admin_url('admin-ajax.php'); ?>', {\n                        method: 'POST',\n                        body: data\n                    })\n                    .then(response => response.text())\n                    .then(variationsOutput => {\n                        if (variationsOutput) {\n                            const variationsElement = document.createElement('div');\n                            variationsElement.className = 'product-variations';\n                            variationsElement.style = 'font-size: 10px; margin-top: 1px;';\n                            variationsElement.innerHTML = variationsOutput;\n\n                            \/\/ Insert after the product title\n                            const titleElement = productContainer.querySelector('.uc_post_title');\n                            if (titleElement) {\n                                titleElement.insertAdjacentElement('afterend', variationsElement);\n                            }\n                        }\n                    });\n                }\n            });\n        });\n    <\/script>\n    <?php\n}\n\n\/\/ AJAX Handler to Fetch Variations (only in\u2010stock)\nadd_action( 'wp_ajax_fetch_product_variations', 'fetch_product_variations' );\nadd_action( 'wp_ajax_nopriv_fetch_product_variations', 'fetch_product_variations' );\n\nfunction fetch_product_variations() {\n    if ( isset( $_POST['product_id'] ) ) {\n        $product_id = intval( $_POST['product_id'] );\n        $product    = wc_get_product( $product_id );\n\n        if ( $product && $product->is_type( 'variable' ) ) {\n            $available_variations = $product->get_available_variations();\n\n            \/\/ Sort by attribute string (case\u2010insensitive)\n            usort( $available_variations, function ( $a, $b ) {\n                $attr_a = implode( ', ', array_values( $a['attributes'] ) );\n                $attr_b = implode( ', ', array_values( $b['attributes'] ) );\n                return strcasecmp( $attr_a, $attr_b );\n            } );\n\n            $variations_output = '';\n\n            foreach ( $available_variations as $variation ) {\n                \/\/ Skip if out of stock\n                if ( isset( $variation['is_in_stock'] ) && ! $variation['is_in_stock'] ) {\n                    continue;\n                }\n\n                $variation_attributes = $variation['attributes'];\n                $attributes_output    = implode( ', ', array_values( $variation_attributes ) );\n\n                if ( ! empty( $attributes_output ) ) {\n                    $variations_output .= '<span>' . esc_html( $attributes_output ) . '<\/span>, ';\n                }\n            }\n\n            $variations_output = rtrim( $variations_output, ', ' );\n\n            if ( ! empty( $variations_output ) ) {\n                echo $variations_output;\n            }\n        }\n    }\n    wp_die();\n}\n","tags":["php"],"active":true,"modified":"2025-06-03 12:25:13","revision":"51"}]}