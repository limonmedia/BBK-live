{"generator":"Code Snippets v3.6.8","date_created":"2025-06-13 05:52","snippets":[{"id":37,"name":"total orders and saved amount on my account page","code":"function display_customer_order_totals() {\n    if ( ! class_exists( 'WooCommerce' ) || ! is_user_logged_in() ) {\n        return '';\n    }\n\n    $user_id = get_current_user_id();\n    $customer_orders = wc_get_orders([\n        'customer_id' => $user_id,\n        'status'      => ['completed', 'processing'],\n        'limit'       => -1,\n    ]);\n\n    $total_used = 0;\n    $total_saved = 0;\n\n    foreach ( $customer_orders as $order ) {\n        foreach ( $order->get_items() as $item ) {\n            $product = $item->get_product();\n            if ( ! $product ) continue;\n\n            $quantity      = $item->get_quantity();\n            $paid_price    = $item->get_total() + $item->get_total_tax(); \/\/ actual paid\n            $regular_price = $product->get_regular_price();\n\n            if ( ! $regular_price ) continue;\n\n            $total_used  += $paid_price;\n            $total_saved += max(0, ($regular_price * $quantity) - $paid_price);\n        }\n    }\n\n    function format_nok($amount) {\n        return number_format($amount, 0, '', ' ') . ' NOK';\n    }\n\n    ob_start(); ?>\n    <div class=\"cart-totals\">\n        <p class=\"price-heading\">Du har handlet for<\/p>\n        <h2 class=\"sale-price\"><?php echo format_nok($total_used); ?><\/h2>\n\n        <p class=\"price-heading\">Du har spart<\/p>\n        <h2 class=\"total-saved\"><?php echo format_nok($total_saved); ?><\/h2>\n\n        <p style=\"margin-top: 10px; margin-bottom: 0px; font-weight: 600; color: #2375B9; font-family:Barlow;\">\n            <a href=\"<?php echo esc_url( wc_get_account_endpoint_url( 'orders' ) ); ?>\">Vis ordrehistorikk>><\/a>\n        <\/p>\n    <\/div>\n\n    <style>\n        .cart-totals { font-family:Barlow; max-width: 400px; }\n        .price-heading { margin: 0; font-size: 16px; font-weight: 500; color: #242424; }\n        .sale-price { margin-top: 0; color: #070707; font-size: 26px !important; }\n        .total-saved { margin-top: 0; color: #d1080f; font-size: 40px !important; }\n    <\/style>\n    <?php\n    return ob_get_clean();\n}\nadd_shortcode( 'order_totals', 'display_customer_order_totals' );\n","active":true,"modified":"2025-05-09 09:47:29","revision":"22"}]}