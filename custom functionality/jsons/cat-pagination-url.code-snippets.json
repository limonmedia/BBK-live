{"generator":"Code Snippets v3.6.8","date_created":"2025-06-13 05:53","snippets":[{"id":53,"name":"Cat Pagination URL","code":"\n\/\/ Customize WooCommerce pagination to use clean category URL without filter parameters\nadd_filter('woocommerce_pagination_args', 'custom_woocommerce_pagination_args');\nfunction custom_woocommerce_pagination_args($args) {\n    \/\/ Get the current category or shop page URL\n    $current_term = is_product_category() ? get_queried_object() : null;\n    $base_url = $current_term && $current_term instanceof WP_Term ? get_term_link($current_term) : get_permalink(woocommerce_get_page_id('shop'));\n\n    \/\/ Normalize base URL\n    $category_path = parse_url($base_url, PHP_URL_PATH);\n    $category_path = trim($category_path, '\/');\n    $base_url = trailingslashit(home_url()) . $category_path . '\/';\n\n    \/\/ Log base URL\n    error_log('WooCommerce Base URL: ' . $base_url);\n\n    \/\/ Set base URL and format for pagination\n    $args['base'] = $base_url . 'page\/%#%\/';\n    $args['format'] = 'page\/%#%\/';\n    $args['add_args'] = []; \/\/ Do not include filter parameters\n\n    return $args;\n}\n\n\/\/ Customize WP Grid Builder pagination to use clean category URL without filter parameters\nadd_filter('wpgb_pagination_args', 'custom_wpgb_pagination_args', 10, 2);\nfunction custom_wpgb_pagination_args($args, $grid_id) {\n    \/\/ Get the current category or shop page URL\n    $current_term = is_product_category() ? get_queried_object() : null;\n    $base_url = $current_term && $current_term instanceof WP_Term ? get_term_link($current_term) : get_permalink(woocommerce_get_page_id('shop'));\n\n    \/\/ Normalize base URL\n    $category_path = parse_url($base_url, PHP_URL_PATH);\n    $category_path = trim($category_path, '\/');\n    $base_url = trailingslashit(home_url()) . $category_path . '\/';\n\n    \/\/ Log base URL\n    error_log('WPGB Base URL: ' . $base_url);\n\n    \/\/ Set base URL and format for pagination\n    $args['base'] = $base_url . 'page\/%#%\/';\n    $args['format'] = 'page\/%#%\/';\n    $args['add_args'] = []; \/\/ Do not include filter parameters\n\n    return $args;\n}\n\n\/\/ Add JavaScript to fix pagination URLs after WPGB AJAX filter application\nadd_action('wp_footer', 'fix_wpgb_pagination_urls');\nfunction fix_wpgb_pagination_urls() {\n    if (is_product_category() || is_shop()) {\n        ?>\n        <script type=\"text\/javascript\">\n            (function($) {\n                \/\/ Get dynamic category base URL\n                var categoryBase = '<?php echo esc_js(trailingslashit(is_product_category() ? get_term_link(get_queried_object()) : get_permalink(woocommerce_get_page_id('shop')))); ?>';\n                console.log('Category Base URL:', categoryBase);\n\n                \/\/ Clean duplicate category paths dynamically\n                function cleanCategoryPath(url) {\n                    var categoryPath = categoryBase.replace(\/^https?:\\\/\\\/[^\\\/]+\/, '').replace(\/\\\/$\/, '');\n                    var regex = new RegExp('(' + categoryPath.replace(\/[-\\\/\\\\^$*+?.()|[\\]{}]\/g, '\\\\$&') + '\/)+', 'g');\n                    return url.replace(regex, categoryPath + '\/');\n                }\n\n                \/\/ Fix pagination links\n                function updatePaginationLinks() {\n                    $('.wpgb-pagination a, .woocommerce-pagination a').each(function() {\n                        var $link = $(this);\n                        var href = $link.attr('href');\n                        if (!href) return;\n\n                        console.log('Original Link:', href);\n\n                        \/\/ Extract page number\n                        var pageNum = '1';\n                        if (href.includes('page\/')) {\n                            var match = href.match(\/page\\\/(\\d+)\/);\n                            pageNum = match ? match[1] : '1';\n                        } else if (href.includes('page=')) {\n                            var match = href.match(\/page=(\\d+)\/);\n                            pageNum = match ? match[1] : '1';\n                        } else if (href.match(\/\\d+$\/)) {\n                            var match = href.match(\/\\d+$\/);\n                            pageNum = match ? match[0] : '1';\n                        }\n\n                        \/\/ Build clean URL\n                        var newHref = categoryBase + 'page\/' + pageNum + '\/';\n                        newHref = cleanCategoryPath(newHref);\n\n                        \/\/ Remove any query parameters\n                        newHref = newHref.split('?')[0];\n\n                        $link.attr('href', newHref);\n                        console.log('Cleaned Link:', newHref);\n                    });\n                    console.log('Pagination links updated');\n                }\n\n                \/\/ Run on page load\n                $(document).ready(function() {\n                    updatePaginationLinks();\n                });\n\n                \/\/ Run after WPGB AJAX filter application\n                $(document).on('wpgb.render', function() {\n                    updatePaginationLinks();\n                });\n            })(jQuery);\n        <\/script>\n        <?php\n    }\n}\n","active":true,"modified":"2025-05-25 07:14:11","revision":"60"}]}