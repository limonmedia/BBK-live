{"generator":"Code Snippets v3.6.8","date_created":"2025-06-13 05:53","snippets":[{"id":56,"name":"Shortcode to display custom checkout items with expandable discount section","code":"\n\/\/ Shortcode to display custom cart items with expandable discount section\nfunction custom_checkout_display() {\n    ob_start();\n    $cart_items = WC()->cart->get_cart();\n    ?><h1 class=\"shopping-cart-title\">Handlekurv<\/h1>\n    <div class=\"order-summary-header\">\n        <div class=\"order-step\">1<\/div>\n        <h2 class=\"order-title\">Ordresammendrag<\/h2>\n    <\/div>\n    <?php\n    $total_saved_price = 0;\n    foreach ($cart_items as $cart_item_key => $cart_item) {\n        $product = $cart_item['data'];\n        $product_id = $cart_item['product_id'];\n        $product_name = $product->get_name();\n\t\t$parts = array_map('trim', explode('-', $product_name));\n        $product_name = implode(' - ', array_slice($parts, 0, 2));\n        $product_price = $product->get_price();\n        $regular_price = $product->get_regular_price();\n        $is_on_sale = $product->is_on_sale();\n        \n\t\t\/\/ Calculate saved price for this product\n    $saved_price = $is_on_sale && $regular_price > $product_price ? $regular_price - $product_price : 0;\n    \n    \/\/ Add to total saved price (multiply by quantity if applicable)\n    $total_saved_price += $saved_price * $cart_item['quantity'];\n\t\t\n        $brand = function_exists('get_field') ? get_field('brand', $product_id) : '';\n        if (empty($brand)) {\n            $categories = get_the_terms($product_id, 'product_cat');\n            if (!empty($categories) && !is_wp_error($categories)) {\n                $brand = $categories[0]->name;\n            }\n        }\n        \n        $attributes = [];\n        if ($product->is_type('variation')) {\n            $variation_attributes = $product->get_variation_attributes();\n            foreach ($variation_attributes as $attribute_name => $attribute_value) {\n                $taxonomy = str_replace('attribute_', '', $attribute_name);\n                $attribute_label = wc_attribute_label($taxonomy);\n                $attributes[$attribute_label] = $attribute_value;\n            }\n        } else {\n            $product_attributes = $product->get_attributes();\n            foreach ($product_attributes as $attribute) {\n                if ($attribute->get_visible()) {\n                    $attribute_label = wc_attribute_label($attribute->get_name());\n                    $attribute_values = $attribute->is_taxonomy() ? wc_get_product_terms($product_id, $attribute->get_name(), ['fields' => 'names']) : $attribute->get_options();\n                    $attributes[$attribute_label] = implode(', ', $attribute_values);\n                }\n            }\n        }\n        \n        ?>\n        <div class=\"elementor-container product-item\">\n            <div class=\"elementor-col-33 product-image\">\n\t\t\t\t<a href=\"<?php echo esc_url($product->get_permalink()); ?>\"><?php \n\t\t\t\t$image_id = $product->get_image_id();\n\t\t\t\t$url = wp_get_attachment_image_url($image_id,'full');\n\t\t\t\t?>\n\t\t\t\t\t<img src=\"<?php echo esc_url($url); ?>\" alt=\"\" \/><\/a>\n\t\t\t<\/div>\n            <div class=\"elementor-col-33 product-details\">\n<!--                 <div class=\"product-brand\"><?php echo esc_html($brand); ?><\/div> -->\n                <div class=\"product-name\"><a style=\"color:#000;\"href=\"<?php echo esc_url($product->get_permalink()); ?>\"><?php echo esc_html($product_name); ?><\/a><\/div>\n                <div class=\"product-attributes\">\n                    <?php foreach ($attributes as $label => $value): ?>\n                    <div class=\"product-attribute\"><?php echo esc_html($label); ?>: <?php echo esc_html($value); ?><\/div>\n                    <?php endforeach; ?>\n                <\/div>\n<!--                 <div class=\"product-quantity\">\n                    <button class=\"quantity-btn\"><span class=\"cq b y p cf a0 cr cs ct ak cu cv bq br\"><svg class=\"quantity-svg\" xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"ci cw cx cy d8\"><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"><\/line><\/svg><\/span><\/button>\n                    <input type=\"text\" class=\"quantity-input\" name=\"<?php echo esc_attr($cart_item_key); ?>\" value=\"<?php echo esc_attr($cart_item['quantity']); ?>\" readonly>\n                    <button class=\"quantity-btn\"><span class=\"cq b y p cf a0 cr cs ct ak cu cv bq br\"><svg class =\"quantity-svg\" xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"ci cw cx cy d8\"><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"><\/line><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"><\/line><\/svg><\/span><\/button>\n                <\/div> -->\n            <\/div>\n            <div class=\"elementor-col-33 price-container\">\n                <div class=\"product-price\"><?php echo $is_on_sale ? wc_price($product_price) : wc_price($product_price); ?><\/div>\n                <?php if ($is_on_sale && $regular_price > $product_price): ?>\n                <div class=\"product-original-price\"><?php echo wc_price($regular_price); ?><\/div>\n                <?php endif; ?>\n                <a href=\"<?php echo esc_url(wc_get_cart_remove_url($cart_item_key)); ?>\" class=\"product-remove\">Fjern<\/a>\n            <\/div>\n        <\/div>\n        <?php\n    }\n    \n    ?>\n\n    <div class=\"checkout-collapsible\">\n        <div class=\"collapsible-header\" id=\"header1\">\n            <span class=\"icon\">+<\/span>\n            <span>Legg til rabattkode<\/span>\n        <\/div>\n        <div class=\"collapsible-content\" id=\"content1\">\n            <div class=\"discount-code-container\">\n                <input type=\"text\" class=\"discount-input\" placeholder=\"Bruk rabattkode\">\n                <button class=\"activate-btn\">Aktiver<\/button>\n            <\/div>\n        <\/div>\n    <\/div>\n <div class=\"checkout-collapsible border-bottom\">\n        <div class=\"collapsible-header\" id=\"header2\">\n            <span class=\"icon\">+<\/span>\n            <span>Legg til gavekort<\/span>\n        <\/div>\n        <div class=\"collapsible-content\" id=\"content2\">\n            <div class=\"discount-code-container\">\n                <input type=\"text\" class=\"discount-input\" placeholder=\"Gavekort-kode\">\n                <button class=\"activate-btn\">Aktiver<\/button>\n            <\/div>\n        <\/div>\n    <\/div>\n    \n    <!-- Order Summary -->\n    <?php\n    $subtotal = WC()->cart->get_subtotal();\n    $discount_total = WC()->cart->get_discount_total();\n    $shipping_total = WC()->cart->get_shipping_total();\n    $tax_total = WC()->cart->get_total_tax();\n\t$subtotal = $subtotal*1.25;\n\t$shipping_total = $shipping_total*1.25;\n    $total = WC()->cart->get_total( 'edit' ); \/\/ Full total including shipping, taxes, discounts\n    ?>\n    <div class=\"order-summary\">\n        <h2 class=\"summary-title\">Oppsummering<\/h2>\n        <div class=\"summary-row sub-total\">\n            <div>Totalt<\/div>\n            <div><?php echo wc_price( $subtotal ); ?><\/div> <!-- Use full total here -->\n        <\/div>\n\t\t\n  \t\t \n        <?php if ($discount_total > 0): ?>\n        <div class=\"summary-row\">\n\t\t\t<div>Rabattkode<\/div>\n\t\t\t<div class=\"negative-value\" style=\"font-weight:normal;\"> \n\t\t\t\t<?php \n\t\t\t\t\/\/ Get discount including VAT\n\t\t\t\t$discount_total_with_tax = WC()->cart->get_discount_total() + WC()->cart->get_discount_tax();\n\t\t\t\techo round($discount_total_with_tax).\",-\";\n\t\t\t\t?>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t\n        <?php endif; ?>\n\t\t<div class=\"summary-row\">\n            <div>Frakt<\/div>\n            <div><?php echo wc_price( $shipping_total ); ?><\/div> \n        <\/div>\n        <!-- <div class=\"summary-row vat\">\n            <div>Du har spart<\/div>\n            <div class=\"negative-value\"><?php echo wc_price($total_saved_price); ?><\/div>\n        <\/div>-->\n\t\t\n\n<div class=\"summary-row vat\">\n            <div>Herav mva<\/div>\n            <div style=\"font-weight:normal;\"><?php \n\t\t\t$net_amount = (($subtotal - $discount_total_with_tax)+$shipping_total) \/1.25;\n\t\t\t$tax_incl_discount = (($subtotal - $discount_total_with_tax)+$shipping_total)-$net_amount;\n\t\t\t\n\t\t\techo number_format($tax_incl_discount,2).\",-\"; ?><\/div>\n        <\/div>\n<div class=\"summary-row \">\n    <div style=\"font-weight:bold;\">Totalt \u00e5 betale<\/div>\n    <div style=\"font-weight:bold;\"><?php \n\t$totalpris = ($subtotal- $discount_total_with_tax)+$shipping_total;\n\techo round($totalpris).\",-\";\n\t\t?><\/div>\n<\/div>\n\t\t\n<!-- \t\t<div class=\"summary-row total\">\n            <div>Totalpris<\/div>\n            <div><\/div>\n        <\/div> -->\n        <?php echo do_shortcode('[wpcfb]'); ?>\n        <div class=\"go-to-payment\">\n            <button class=\"payment-btn\">VIDERE TIL BETALING<\/button>\n        <\/div>\n    <\/div>\n    <?php\n    \n    return ob_get_clean();\n}\nadd_shortcode('custom_checkout_display', 'custom_checkout_display');","active":true,"modified":"2025-06-08 15:43:02","revision":"67"}]}